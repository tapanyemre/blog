<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=language content="en"><meta name=viewport content="width=device-width"><title>Quick tip: Automatic test runs when files change | Yunus Emre Tapan
</title><meta name=description content="How to use watchexec to get instant feedback from your tests when you change a file in your Go project."><link rel=icon type=image/svg+xml href=https://tapanyemre.github.io/blog/images/favicon.svg><link rel=icon type=image/png href=https://tapanyemre.github.io/blog/images/favicon.png><meta property="og:url" content="https://tapanyemre.github.io/blog/posts/automatically-run-go-test-on-file-changes/"><meta property="og:site_name" content="Yunus Emre Tapan"><meta property="og:title" content="Quick tip: Automatic test runs when files change"><meta property="og:description" content="How to use watchexec to get instant feedback from your tests when you change a file in your Go project."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-17T00:00:00+00:00"><meta itemprop=name content="Quick tip: Automatic test runs when files change"><meta itemprop=description content="How to use watchexec to get instant feedback from your tests when you change a file in your Go project."><meta itemprop=datePublished content="2023-12-17T00:00:00+00:00"><meta itemprop=wordCount content="297"><meta itemprop=keywords content="Programming,Golang,Testing,Quick-tip"><meta name=twitter:card content="summary"><meta name=twitter:title content="Quick tip: Automatic test runs when files change"><meta name=twitter:description content="How to use watchexec to get instant feedback from your tests when you change a file in your Go project."><link rel=canonical href=https://tapanyemre.github.io/blog/posts/automatically-run-go-test-on-file-changes/><link rel=stylesheet href=https://tapanyemre.github.io/blog/css/index.min.7dc5bce5e48ff3fe71c582eac851646db39f1a70e9dc6198c199a3189731869e.css integrity="sha256-fcW85eSP8/5xxYLqyFFkbbOfGnDp3GGYwZmjGJcxhp4=" crossorigin=anonymous><script src=https://tapanyemre.github.io/blog/js/main.d08dd7bf84e75145632853df5565c828a4a44de84df4bf08672d692241737c30.js integrity="sha256-0I3Xv4TnUUVjKFPfVWXIKKSkTehN9L8IZy1pIkFzfDA=" crossorigin=anonymous defer></script><script type=application/ld+json>{"@context":"https://schema.org/","@id":"https://tapanyemre.github.io/blog/posts/automatically-run-go-test-on-file-changes/","@type":"BlogPosting","articleSection":["Programming","Golang","Testing","Quick-tip"],"author":{"@type":"Person","email":"tapanyemre@gmail.com","name":"Yunus Emre Tapan","url":"https://tapanyemre.github.io/blog/about/"},"copyrightNotice":"Yunus Emre Tapan","datePublished":"2023-12-17","description":"How to use watchexec to get instant feedback from your tests when you change a file in your Go project.","headline":"Quick tip: Automatic test runs when files change","isPartOf":{"@id":"https://tapanyemre.github.io/blog/posts/","@type":"Blog","name":"Posts"},"mainEntityOfPage":"https://tapanyemre.github.io/blog/posts/automatically-run-go-test-on-file-changes/","name":"Quick tip: Automatic test runs when files change","timeRequired":"PT2M","url":"https://tapanyemre.github.io/blog/posts/automatically-run-go-test-on-file-changes/","wordCount":297}</script></head><body><div class="container mx-auto flex max-w-prose flex-col space-y-10 p-4 md:p-6"><header class="flex flex-row items-center justify-between"><div><a id=skip-nav class=sr-only href=#maincontent>Skip to main content</a>
<a class=font-semibold href=https://tapanyemre.github.io/blog/>Yunus Emre Tapan</a></div><nav><ul class="flex flex-row items-center justify-end space-x-4"><li><a href=https://tapanyemre.github.io/blog/about/>About</a></li><li><a aria-current=true class=ancestor href=https://tapanyemre.github.io/blog/posts/>Posts</a></li><li><a href=https://tapanyemre.github.io/blog/notes/>Notes</a></li><li><a href=https://tapanyemre.github.io/blog/graph/>Graph</a></li></ul></nav></header><main class="prose prose-slate relative md:prose-lg prose-h1:text-[2em]" id=maincontent><article class=main><header><h1 class=!mb-1>Quick tip: Automatic test runs when files change</h1><div class="flex flex-row items-center space-x-4"><time class="text-sm italic opacity-80" datetime=2023-12-17T00:00:00+00:00>December 17, 2023</time></div></header><p class=lead>How to use watchexec to get instant feedback from your tests when you change a file in your Go project.</p><p>I discovered <a href=https://github.com/watchexec/watchexec>watchexec</a> a while ago and it&rsquo;s been a nifty tool to have for performing all kinds of tasks when
files change. It&rsquo;s a cross-platform tool written in Rust, well maintained, reliable, and easy to use.</p><p>One of the things I frequently use it for, is to automatically run tests for a package when I change a file in it:</p><figure class="codeblock not-prose relative scroll-mt-8" id=codeblock-01><aside class="absolute right-0 top-0 hidden rounded-bl-sm rounded-tr-sm bg-white/10 px-2 py-1 text-white/70 transition-opacity md:inline-block"><div class="codeblock-meta flex max-w-xs flex-row items-center space-x-3"><div class="small-caps shrink cursor-default truncate font-mono text-xs" aria-hidden=true><span class=relative>bash</span></div><div><clipboard-copy type=button aria-label="Copy code to clipboard" title="Copy code to clipboard" class="block cursor-pointer transition-colors hover:text-sky-400" target="#codeblock-01 code"><svg fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard h-4 w-4" viewBox="0 0 24 24"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/></svg></clipboard-copy></div><div><a href=#codeblock-01 class=block aria-label="Link to this code block" title="Link to this code block"><svg width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-link w-4 h-4 block" viewBox="0 0 24 24"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></div></div></aside><p class=sr-only>bash code snippet start</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>watchexec       <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -c clear      <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -o <span class=k>do</span>-nothing <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d 100ms      <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --exts go     <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=s1>&#39;pkg=&#34;.${WATCHEXEC_COMMON_PATH/$PWD/}/...&#34;; echo &#34;running tests for $pkg&#34;; go test &#34;$pkg&#34;&#39;</span></span></span></code></pre></div><p class=sr-only>bash code snippet end</p></figure><ul><li><code>-c clear</code> clears the screen before every run</li><li><code>-o do-nothing</code> drops any test runs if there&rsquo;s already one running</li><li><code>-d 100ms</code> debounces file changes for 100 milliseconds to allow for multiple changes to happen at once</li><li><code>-exts go</code> filters file events to only <code>.go</code> files</li><li><code>pkg=".${WATCHEXEC_COMMON_PATH/$PWD/}/..."</code> constructs the package path to run by trimming away the current working
directory from a special environment variable that watchexec sets which holds the directory of the changed file</li></ul><p>The command is a bit of a mouthful, so I can recommend setting up an alias for it:</p><figure class="codeblock not-prose relative scroll-mt-8" id=codeblock-02><aside class="absolute right-0 top-0 hidden rounded-bl-sm rounded-tr-sm bg-white/10 px-2 py-1 text-white/70 transition-opacity md:inline-block"><div class="codeblock-meta flex max-w-xs flex-row items-center space-x-3"><div class="small-caps shrink cursor-default truncate font-mono text-xs" aria-hidden=true><span class=relative>bash</span></div><div><clipboard-copy type=button aria-label="Copy code to clipboard" title="Copy code to clipboard" class="block cursor-pointer transition-colors hover:text-sky-400" target="#codeblock-02 code"><svg fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard h-4 w-4" viewBox="0 0 24 24"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/></svg></clipboard-copy></div><div><a href=#codeblock-02 class=block aria-label="Link to this code block" title="Link to this code block"><svg width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-link w-4 h-4 block" viewBox="0 0 24 24"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></div></div></aside><p class=sr-only>bash code snippet start</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Automatically run `go test` for a package when files change.</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>autotest</span><span class=o>=</span><span class=s2>&#34;watchexec -c clear -o do-nothing -d 100ms --exts go &#39;pkg=\&#34;.\${WATCHEXEC_COMMON_PATH/\$PWD/}/...\&#34;; echo \&#34;running tests for \$pkg\&#34;; go test \&#34;\$pkg\&#34;&#39;&#34;</span></span></span></code></pre></div><p class=sr-only>bash code snippet end</p></figure><figure role=note id=admonition-00 aria-labelledby=admonition-caption-00 class="admonition tip not-prose"><div class="flex items-center space-x-2 pb-2 font-semibold"><svg width="24" height="24" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-flame block"><path d="M8.5 14.5A2.5 2.5.0 0011 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5s3 3.5 3 5.5A7 7 0 115 15c0-1.153.433-2.294 1-3a2.5 2.5.0 002.5 2.5z"/></svg><figcaption id=admonition-caption-00>Fancy web UI with gokiburi</figcaption></div><div class="prose pl-8 text-inherit marker:text-inherit"><p>I guess I can&rsquo;t mention automatic test runs without also mentioning a project of mine called <a href=https://github.com/michenriksen/gokiburi>gokiburi</a>. It watches for
file changes similarly to watchexec, and presents the results in a spiffy web UI with coverage view, browser
notifications, sound notifications, and more.</p><p><a href=https://github.com/michenriksen/gokiburi>Read more on GitHub</a>.</p></div></figure></article><aside class="not-prose flex flex-col space-y-8 border-t pt-6"><section class="flex flex-col space-y-4"><h2 class="flex flex-row items-center space-x-2 text-lg font-semibold"><svg fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-shapes h-4 w-4" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.3 10a.7.7.0 01-.626-1.079L11.4 3a.7.7.0 011.198-.043L16.3 8.9a.7.7.0 01-.572 1.1z"/><rect width="7" height="7" x="3" y="14" rx="1"/><circle cx="17.5" cy="17.5" r="3.5"/></svg>
<span>Categories</span></h2><ul class="ml-6 flex flex-row flex-wrap items-center space-x-2"><li><a href=https://tapanyemre.github.io/blog/categories/programming/ class="taxonomy category">programming</a></li><li><a href=https://tapanyemre.github.io/blog/categories/golang/ class="taxonomy category">Golang</a></li><li><a href=https://tapanyemre.github.io/blog/categories/testing/ class="taxonomy category">testing</a></li><li><a href=https://tapanyemre.github.io/blog/categories/quick-tip/ class="taxonomy category">quick-tip</a></li></ul></section><section class="flex flex-col space-y-4" aria-hidden=true><h2 class="flex flex-row items-center space-x-2 text-lg font-semibold"><svg fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-chart-network h-4 w-4" viewBox="0 0 24 24" aria-hidden="true"><path d="m13.11 7.664 1.78 2.672M14.162 12.788l-3.324 1.424M20 4l-6.06 1.515M3 3v16a2 2 0 002 2h16"/><circle cx="12" cy="6" r="2"/><circle cx="16" cy="12" r="2"/><circle cx="9" cy="15" r="2"/></svg>
<span>Graph</span></h2><content-network-graph class="h-64 ml-6" data-endpoint=/graph/index.json page=/posts/automatically-run-go-test-on-file-changes/></content-network-graph></section></aside></main><footer class="mt-20 border-t border-neutral-100 pt-2 text-xs"></footer></div></body></html>